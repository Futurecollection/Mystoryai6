
{% extends "base.html" %}

{% block content %}
<h1>Full Story So Far</h1>

<div class="p-3 mb-3" style="background: rgba(255,255,255,0.1); white-space: pre-wrap;">
  {% if lines %}
    {% for text in lines %}
      {% if text.startswith('> ') %}
        <div style="margin-bottom: 0.5rem; color: #88ff88;">{{ text }}</div>
      {% elif text.startswith('IMAGE_URL => ') %}
        <div class="text-center mb-4">
          <img src="{{ url_for('view_image') }}" alt="Scene Image" style="max-width: 60%;">
        </div>
      {% else %}
        <div style="margin-bottom: 1.5rem;">{{ text }}</div>
      {% endif %}
    {% endfor %}
  {% else %}
    <p>(No story narration yet.)</p>
  {% endif %}
</div>

<!-- Form for erotica generation with prompt -->
<form method="POST" action="{{ url_for('generate_erotica') }}" class="mb-3">
  <div class="mb-2">
    <label class="form-label">Custom Instructions (optional):</label>
    <textarea name="erotica_prompt" class="form-control" rows="2" 
              placeholder="E.g.: Make it more romantic, focus on emotional connection, etc."></textarea>
  </div>
  <div class="form-check mt-2">
    <input class="form-check-input" type="checkbox" name="use_previous_prompt" id="usePreviousPrompt">
    <label class="form-check-label" for="usePreviousPrompt">
      Build on previous prompt
    </label>
  </div>
  <button type="submit" class="btn btn-danger">Generate Erotica</button>
</form>

<hr>
<a href="{{ url_for('interaction') }}" class="btn btn-secondary">Back to Interaction</a>
{% endblock %}

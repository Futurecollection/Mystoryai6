{% extends "base.html" %}

{% block content %}
<h1>Update Character & Environment</h1>

<form method="POST" class="row g-3 mb-4">
  <!-- NPC Name -->
  <div class="col-md-6">
    <label class="form-label">NPC Name</label>
    <select class="form-select mb-1" name="npc_name">
      <option value="">--Select--</option>
      {% for nn in npc_name_options %}
        {% if nn == session['npc_name'] %}
          <option value="{{ nn }}" selected>{{ nn }}</option>
        {% else %}
          <option value="{{ nn }}">{{ nn }}</option>
        {% endif %}
      {% endfor %}
    </select>
    {% set name_in_list = session['npc_name'] in npc_name_options %}
    <label>Or custom:</label>
    <input type="text" class="form-control" 
           name="npc_name_custom"
           value="{% if not name_in_list %}{{ session['npc_name'] }}{% endif %}">
  </div>

  <!-- NPC Gender -->
  <div class="col-md-6">
    <label class="form-label">NPC Gender</label>
    <select class="form-select mb-1" name="npc_gender">
      <option value="">--Select--</option>
      {% for gopt in npc_gender_options %}
        {% if gopt == session['npc_gender'] %}
          <option value="{{ gopt }}" selected>{{ gopt }}</option>
        {% else %}
          <option value="{{ gopt }}">{{ gopt }}</option>
        {% endif %}
      {% endfor %}
    </select>
    {% set gender_in_list = session['npc_gender'] in npc_gender_options %}
    <label>Or custom:</label>
    <input type="text" class="form-control"
           name="npc_gender_custom"
           value="{% if not gender_in_list %}{{ session['npc_gender'] }}{% endif %}">
  </div>

  <!-- NPC Age -->
  <div class="col-md-6">
    <label class="form-label">NPC Age</label>
    <select class="form-select mb-1" name="npc_age">
      <option value="">--Select--</option>
      {% for aopt in npc_age_options %}
        {% if aopt == session['npc_age'] %}
          <option value="{{ aopt }}" selected>{{ aopt }}</option>
        {% else %}
          <option value="{{ aopt }}">{{ aopt }}</option>
        {% endif %}
      {% endfor %}
    </select>
    {% set age_in_list = session['npc_age'] in npc_age_options %}
    <label>Or custom:</label>
    <input type="text" class="form-control"
           name="npc_age_custom"
           value="{% if not age_in_list %}{{ session['npc_age'] }}{% endif %}">
  </div>

  <!-- NPC Ethnicity -->
  <div class="col-md-6">
    <label class="form-label">NPC Ethnicity</label>
    <select class="form-select mb-1" name="npc_ethnicity">
      <option value="">--Select--</option>
      <style>
        optgroup {
            font-size: 2.6em;
            font-weight: 900;
            color: #ff5789;
            background-color: #4a0f0f;
            padding: 8px;
            margin: 4px 0;
          }
          option {
            background-color: #2a0a0a;
            color: #f8d0d0;
            padding: 4px;
          }
      </style>
      <optgroup label="Americas">
        <option value="American (Black)" {% if session['npc_ethnicity'] == "American (Black)" %}selected{% endif %}>American (Black)</option>
        <option value="American (White)" {% if session['npc_ethnicity'] == "American (White)" %}selected{% endif %}>American (White)</option>
        <option value="Hispanic" {% if session['npc_ethnicity'] == "Hispanic" %}selected{% endif %}>Hispanic</option>
        <option value="Brazilian" {% if session['npc_ethnicity'] == "Brazilian" %}selected{% endif %}>Brazilian</option>
      </optgroup>
      <optgroup label="European">
        <option value="British" {% if session['npc_ethnicity'] == "British" %}selected{% endif %}>British</option>
        <option value="Irish" {% if session['npc_ethnicity'] == "Irish" %}selected{% endif %}>Irish</option>
        <option value="Scottish" {% if session['npc_ethnicity'] == "Scottish" %}selected{% endif %}>Scottish</option>
        <option value="Welsh" {% if session['npc_ethnicity'] == "Welsh" %}selected{% endif %}>Welsh</option>
        <option value="French" {% if session['npc_ethnicity'] == "French" %}selected{% endif %}>French</option>
        <option value="German" {% if session['npc_ethnicity'] == "German" %}selected{% endif %}>German</option>
        <option value="Dutch" {% if session['npc_ethnicity'] == "Dutch" %}selected{% endif %}>Dutch</option>
        <option value="Danish" {% if session['npc_ethnicity'] == "Danish" %}selected{% endif %}>Danish</option>
        <option value="Norwegian" {% if session['npc_ethnicity'] == "Norwegian" %}selected{% endif %}>Norwegian</option>
        <option value="Swedish" {% if session['npc_ethnicity'] == "Swedish" %}selected{% endif %}>Swedish</option>
        <option value="Italian" {% if session['npc_ethnicity'] == "Italian" %}selected{% endif %}>Italian</option>
        <option value="Greek" {% if session['npc_ethnicity'] == "Greek" %}selected{% endif %}>Greek</option>
        <option value="Spanish" {% if session['npc_ethnicity'] == "Spanish" %}selected{% endif %}>Spanish</option>
        <option value="Portuguese" {% if session['npc_ethnicity'] == "Portuguese" %}selected{% endif %}>Portuguese</option>
        <option value="Russian" {% if session['npc_ethnicity'] == "Russian" %}selected{% endif %}>Russian</option>
        <option value="Ukrainian" {% if session['npc_ethnicity'] == "Ukrainian" %}selected{% endif %}>Ukrainian</option>
        <option value="Polish" {% if session['npc_ethnicity'] == "Polish" %}selected{% endif %}>Polish</option>
        <option value="Czech" {% if session['npc_ethnicity'] == "Czech" %}selected{% endif %}>Czech</option>
        <option value="Slovak" {% if session['npc_ethnicity'] == "Slovak" %}selected{% endif %}>Slovak</option>
        <option value="Croatian" {% if session['npc_ethnicity'] == "Croatian" %}selected{% endif %}>Croatian</option>
        <option value="Serbian" {% if session['npc_ethnicity'] == "Serbian" %}selected{% endif %}>Serbian</option>
      </optgroup>
      <optgroup label="Asian">
        <option value="Chinese" {% if session['npc_ethnicity'] == "Chinese" %}selected{% endif %}>Chinese</option>
        <option value="Japanese" {% if session['npc_ethnicity'] == "Japanese" %}selected{% endif %}>Japanese</option>
        <option value="Korean" {% if session['npc_ethnicity'] == "Korean" %}selected{% endif %}>Korean</option>
        <option value="Vietnamese" {% if session['npc_ethnicity'] == "Vietnamese" %}selected{% endif %}>Vietnamese</option>
        <option value="Thai" {% if session['npc_ethnicity'] == "Thai" %}selected{% endif %}>Thai</option>
        <option value="Indian" {% if session['npc_ethnicity'] == "Indian" %}selected{% endif %}>Indian</option>
        <option value="Pakistani" {% if session['npc_ethnicity'] == "Pakistani" %}selected{% endif %}>Pakistani</option>
        <option value="Filipino" {% if session['npc_ethnicity'] == "Filipino" %}selected{% endif %}>Filipino</option>
      </optgroup>
      <optgroup label="Oceania">
        <option value="Australian" {% if session['npc_ethnicity'] == "Australian" %}selected{% endif %}>Australian</option>
      </optgroup>
      <optgroup label="Other">
        <option value="Turkish" {% if session['npc_ethnicity'] == "Turkish" %}selected{% endif %}>Turkish</option>
        <option value="Middle Eastern" {% if session['npc_ethnicity'] == "Middle Eastern" %}selected{% endif %}>Middle Eastern</option>
        <option value="Other" {% if session['npc_ethnicity'] == "Other" %}selected{% endif %}>Other</option>
      </optgroup>
    </select>
    {% set eth_in_list = session['npc_ethnicity'] in ethnicity_options %}
    <label>Or custom:</label>
    <input type="text" class="form-control"
           name="npc_ethnicity_custom"
           value="{% if not eth_in_list %}{{ session['npc_ethnicity'] }}{% endif %}">
  </div>

  <!-- NPC Body Type -->
  <div class="col-md-6">
    <label class="form-label">NPC Body Type</label>
    <select class="form-select mb-1" name="npc_body_type">
      <option value="">--Select--</option>
      {% for bopt in body_type_options %}
        {% if bopt == session['npc_body_type'] %}
          <option value="{{ bopt }}" selected>{{ bopt }}</option>
        {% else %}
          <option value="{{ bopt }}">{{ bopt }}</option>
        {% endif %}
      {% endfor %}
    </select>
    {% set body_in_list = session['npc_body_type'] in body_type_options %}
    <label>Or custom:</label>
    <input type="text" class="form-control"
           name="npc_body_type_custom"
           value="{% if not body_in_list %}{{ session['npc_body_type'] }}{% endif %}">
  </div>

  <!-- NPC Hair Color -->
  <div class="col-md-6">
    <label class="form-label">NPC Hair Color</label>
    <select class="form-select mb-1" name="npc_hair_color">
      <option value="">--Select--</option>
      {% for hc in hair_color_options %}
        {% if hc == session['npc_hair_color'] %}
          <option value="{{ hc }}" selected>{{ hc }}</option>
        {% else %}
          <option value="{{ hc }}">{{ hc }}</option>
        {% endif %}
      {% endfor %}
    </select>
    {% set hc_in_list = session['npc_hair_color'] in hair_color_options %}
    <label>Or custom:</label>
    <input type="text" class="form-control"
           name="npc_hair_color_custom"
           value="{% if not hc_in_list %}{{ session['npc_hair_color'] }}{% endif %}">
  </div>

  <!-- NPC Hair Style -->
  <div class="col-md-6">
    <label class="form-label">NPC Hair Style</label>
    <select class="form-select mb-1" name="npc_hair_style">
      <option value="">--Select--</option>
      {% for hs in hair_style_options %}
        {% if hs == session['npc_hair_style'] %}
          <option value="{{ hs }}" selected>{{ hs }}</option>
        {% else %}
          <option value="{{ hs }}">{{ hs }}</option>
        {% endif %}
      {% endfor %}
    </select>
    {% set hairst_in_list = session['npc_hair_style'] in hair_style_options %}
    <label>Or custom:</label>
    <input type="text" class="form-control"
           name="npc_hair_style_custom"
           value="{% if not hairst_in_list %}{{ session['npc_hair_style'] }}{% endif %}">
  </div>

  <!-- NPC Personality -->
  <div class="col-md-6">
    <label class="form-label">NPC Personality</label>
    <select class="form-select mb-1" name="npc_personality">
      <option value="">--Select--</option>
      {% for pers in npc_personality_options %}
        {% if pers == session['npc_personality'] %}
          <option value="{{ pers }}" selected>{{ pers }}</option>
        {% else %}
          <option value="{{ pers }}">{{ pers }}</option>
        {% endif %}
      {% endfor %}
    </select>
    {% set pers_in_list = session['npc_personality'] in npc_personality_options %}
    <label>Or custom:</label>
    <input type="text" class="form-control"
           name="npc_personality_custom"
           value="{% if not pers_in_list %}{{ session['npc_personality'] }}{% endif %}">
  </div>

  <!-- NPC Clothing -->
  <div class="col-md-6">
    <label class="form-label">NPC Clothing</label>
    <select class="form-select mb-1" name="npc_clothing">
      <option value="">--Select--</option>
      {% for copt in clothing_options %}
        {% if copt == session['npc_clothing'] %}
          <option value="{{ copt }}" selected>{{ copt }}</option>
        {% else %}
          <option value="{{ copt }}">{{ copt }}</option>
        {% endif %}
      {% endfor %}
    </select>
    {% set cloth_in_list = session['npc_clothing'] in clothing_options %}
    <label>Or custom:</label>
    <input type="text" class="form-control"
           name="npc_clothing_custom"
           value="{% if not cloth_in_list %}{{ session['npc_clothing'] }}{% endif %}">
  </div>

  <!-- NPC Occupation -->
  <div class="col-md-6">
    <label class="form-label">NPC Occupation</label>
    <select class="form-select mb-1" name="npc_occupation">
      <option value="">--Select--</option>
      {% for occ in occupation_options %}
        {% if occ == session['npc_occupation'] %}
          <option value="{{ occ }}" selected>{{ occ }}</option>
        {% else %}
          <option value="{{ occ }}">{{ occ }}</option>
        {% endif %}
      {% endfor %}
    </select>
    {% set occ_in_list = session['npc_occupation'] in occupation_options %}
    <label>Or custom:</label>
    <input type="text" class="form-control"
           name="npc_occupation_custom"
           value="{% if not occ_in_list %}{{ session['npc_occupation'] }}{% endif %}">
  </div>

  <!-- NPC Current Situation -->
  <div class="col-md-6">
    <label class="form-label">NPC Current Situation</label>
    <select class="form-select mb-1" name="npc_current_situation">
      <option value="">--Select--</option>
      {% for cs in current_situation_options %}
        {% if cs == session['npc_current_situation'] %}
          <option value="{{ cs }}" selected>{{ cs }}</option>
        {% else %}
          <option value="{{ cs }}">{{ cs }}</option>
        {% endif %}
      {% endfor %}
    </select>
    {% set cs_in_list = session['npc_current_situation'] in current_situation_options %}
    <label>Or custom:</label>
    <input type="text" class="form-control"
           name="npc_current_situation_custom"
           value="{% if not cs_in_list %}{{ session['npc_current_situation'] }}{% endif %}">
  </div>

  <!-- Environment -->
  <div class="col-md-6">
    <label class="form-label">Environment / Location</label>
    <select class="form-select mb-1" name="environment">
      <option value="">--Select--</option>
      {% for envopt in environment_options %}
        {% if envopt == session['environment'] %}
          <option value="{{ envopt }}" selected>{{ envopt }}</option>
        {% else %}
          <option value="{{ envopt }}">{{ envopt }}</option>
        {% endif %}
      {% endfor %}
    </select>
    {% set env_in_list = session['environment'] in environment_options %}
    <label>Or custom:</label>
    <input type="text" class="form-control"
           name="environment_custom"
           value="{% if not env_in_list %}{{ session['environment'] }}{% endif %}">
  </div>

  <!-- Encounter Context -->
  <div class="col-md-6">
    <label class="form-label">Encounter Context</label>
    <select class="form-select mb-1" name="encounter_context">
      <option value="">--Select--</option>
      {% for ctxopt in encounter_context_options %}
        {% if ctxopt == session['encounter_context'] %}
          <option value="{{ ctxopt }}" selected>{{ ctxopt }}</option>
        {% else %}
          <option value="{{ ctxopt }}">{{ ctxopt }}</option>
        {% endif %}
      {% endfor %}
    </select>
    {% set ctx_in_list = session['encounter_context'] in encounter_context_options %}
    <label>Or custom:</label>
    <input type="text" class="form-control"
           name="encounter_context_custom"
           value="{% if not ctx_in_list %}{{ session['encounter_context'] }}{% endif %}">
  </div>

  <input type="hidden" name="npc_backstory" value="{{ session['npc_backstory'] }}">

  <div class="col-12">
    <button type="submit" name="update_npc" value="true" class="btn btn-warning">
      Update Settings
    </button>
    <a href="{{ url_for('interaction') }}" class="btn btn-secondary ms-2">
      Back to Story
    </a>
  </div>
</form>
{% endblock %}
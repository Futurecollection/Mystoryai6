{% extends "base.html" %}

{% block content %}
<h1 style="color: #ff9fa3;" class="mb-4">
  <i class="bi bi-journal-richtext"></i> NPC Memory & Thoughts Editor
</h1>

<div class="card mb-4" style="background-color: #4a0d0d; border: 1px solid #ff5789;">
  <div class="card-header" style="background-color: #5f1c1c; color: #f8d0d0; border-bottom: 1px solid #ff5789;">
    <h3 style="margin-bottom: 0;"><i class="bi bi-lightbulb"></i> {{ session.get('npc_name', 'Character') }}'s Private Thoughts</h3>
    <small style="opacity: 0.8;">Represents the character's internal monologue, emotional reactions, and reasoning process</small>
  </div>
  <div class="card-body" style="background-color: #3b0b0b;">
    <div style="white-space: pre-wrap; padding: 15px; border-radius: 8px; max-height: 300px; overflow-y: auto; background-color: #2a0808; color: #ffd0d0; font-size: 1.05rem; line-height: 1.5; box-shadow: inset 0 0 10px rgba(0,0,0,0.5);">{{ session.get('npcPrivateThoughts', '(None)') }}</div>
  </div>
</div>

<div class="card mb-4" style="background-color: #4a0d0d; border: 1px solid #ff5789;">
  <div class="card-header" style="background-color: #5f1c1c; color: #f8d0d0; border-bottom: 1px solid #ff5789;">
    <h3 style="margin-bottom: 0;"><i class="bi bi-journal-text"></i> {{ session.get('npc_name', 'Character') }}'s Biography & Memories</h3>
    <small style="opacity: 0.8;">Key biographical information, past experiences, and relationship developments</small>
  </div>
  <div class="card-body" style="background-color: #3b0b0b;">
    <div style="white-space: pre-wrap; padding: 15px; border-radius: 8px; max-height: 300px; overflow-y: auto; background-color: #2a0808; color: #ffd0d0; font-size: 1.05rem; line-height: 1.5; box-shadow: inset 0 0 10px rgba(0,0,0,0.5);">{{ session.get('npcBehavior', '(None)') }}</div>
  </div>
</div>

<div class="card mb-4" style="background-color: #4a0d0d; border: 1px solid #ff5789;">
  <div class="card-header" style="background-color: #5f1c1c; color: #f8d0d0; border-bottom: 1px solid #ff5789;">
    <h3 style="margin-bottom: 0;"><i class="bi bi-pencil-square"></i> Add New Content</h3>
  </div>
  <div class="card-body">
    <form method="POST">
      <div class="mb-3">
        <label class="form-label" style="color: #f8d0d0; font-weight: bold;">Select where to add:</label>
        <select name="target" class="form-select" style="background-color: #3b0b0b; color: #f8d0d0; border: 1px solid #6d1d1d;">
          <option value="thoughts">Private Thoughts (internal monologue, reactions, and feelings)</option>
          <option value="memories">Biography & Memories (background info, experiences, and revelations)</option>
          <option value="reset_bio">Reset Biography Format (Free-form)</option>
        </select>
        <small class="text-muted" style="color: #ff9fa3 !important;">
          <i class="bi bi-info-circle"></i> For Biography updates, you can add entirely new background elements, traits, history, or modify existing details.
        </small>
      </div>

      <div class="mb-3">
        <label class="form-label" style="color: #f8d0d0; font-weight: bold;">Enter new content:</label>
        <textarea name="new_text" class="form-control" rows="6" style="background-color: #2a0808; color: #ffd0d0; border: 1px solid #6d1d1d;" 
                  placeholder="For Biography & Memories (be detailed and specific):
'During our conversation at the cafÃ©, I revealed that I lived in Paris for three years during college. Those years shaped my appreciation for art and cuisine, and I still keep in touch with my host family. It was the first time I've shared this part of my life with someone in years.'

For Private Thoughts (introspective, personal):
'The way they asked about my time abroad caught me off guard. I usually keep those memories to myself - they're precious to me. But something about their genuine interest made me want to share. I wonder if they could tell how much that period of my life meant to me... there's still so much I didn't say.'"></textarea>
      </div>

      <div class="d-flex justify-content-between">
        <button type="submit" class="btn" style="background-color: #ff5789; color: white; font-weight: bold;">
          <i class="bi bi-plus-circle"></i> Add to Character
        </button>
        <a href="{{ url_for('interaction') }}" class="btn" style="background-color: #5f1c1c; color: #f8d0d0;">
          <i class="bi bi-arrow-left"></i> Return to Story
        </a>
      </div>
    </form>
  </div>
</div>

<div class="card mb-4" style="background-color: #4a0d0d; border: 1px solid #ff5789;">
  <div class="card-header" style="background-color: #5f1c1c; color: #f8d0d0; border-bottom: 1px solid #ff5789;">
    <h4 style="margin-bottom: 0;"><i class="bi bi-info-circle"></i> How Character Memory Works</h4>
  </div>
  <div class="card-body" style="background-color: #3b0b0b;">
    <div class="mb-3" style="color: #ffd0d0;">
      <h5><i class="bi bi-journal-text"></i> Biography & Memories:</h5>
      <ul>
        <li><strong>Background Information:</strong> Character's history, upbringing, and formative experiences</li>
        <li><strong>Self-Discovery:</strong> New aspects of personality or past revealed through interactions</li>
        <li><strong>Relationship Timeline:</strong> Key events and milestones between the NPC and user</li>
        <li><strong>Learning About User:</strong> Discoveries about the user's life, preferences, and history</li>
      </ul>
    </div>

    <div style="color: #ffd0d0;">
      <h5><i class="bi bi-lightbulb"></i> Private Thoughts:</h5>
      <ul>
        <li><strong>Emotional Processing:</strong> Raw reactions to recent interactions with the user</li>
        <li><strong>Inner Conflicts:</strong> Personal struggles, hesitations, or excitement not expressed openly</li>
        <li><strong>Reflections:</strong> Contemplation on evolving feelings and the relationship's development</li>
        <li><strong>Unspoken Intentions:</strong> Desires or plans the character is considering but hasn't shared</li>
      </ul>
    </div>
  </div>
</div>
{% endblock %}